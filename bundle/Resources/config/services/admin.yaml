services:
    netgen_layouts.ibexa.admin.controller.base:
        class: Netgen\Bundle\LayoutsIbexaBundle\Controller\Admin\Controller
        abstract: true
        calls:
            - setContainer: ["@service_container"]
            - checkPermissions: []

    netgen_layouts.ibexa.admin.controller.location_layouts:
        class: Netgen\Bundle\LayoutsIbexaBundle\Controller\Admin\LocationLayouts
        parent: netgen_layouts.ibexa.admin.controller.base
        arguments:
            - "@ibexa.api.service.content"
            - "@netgen_layouts.layout.resolver"
            - "@netgen_layouts.ibexa.admin.related_layouts_loader"
            - "@netgen_layouts.ibexa.components.components_layout_loader"
        tags:
            - { name: container.service_subscriber }
            - { name: controller.service_arguments }

    netgen_layouts.ibexa.admin.controller.layout_wizard:
        class: Netgen\Bundle\LayoutsIbexaBundle\Controller\Admin\LayoutWizard
        parent: netgen_layouts.ibexa.admin.controller.base
        arguments:
            - "@netgen_layouts.api.service.layout"
            - "@netgen_layouts.layout.registry.layout_type"
        tags:
            - { name: container.service_subscriber }
            - { name: controller.service_arguments }

    netgen_layouts.ibexa.admin.controller.layout_wizard_callback:
        class: Netgen\Bundle\LayoutsIbexaBundle\Controller\Admin\LayoutWizardCallback
        parent: netgen_layouts.ibexa.admin.controller.base
        arguments:
            - "@netgen_layouts.api.service.layout"
            - "@netgen_layouts.api.service.layout_resolver"
        tags:
            - { name: container.service_subscriber }
            - { name: controller.service_arguments }

    netgen_layouts.ibexa.admin.controller.create_content:
        class: Netgen\Bundle\LayoutsIbexaBundle\Controller\Admin\CreateContent
        parent: netgen_layouts.ibexa.admin.controller.base
        arguments:
            - "@ibexa.api.service.location"
            - "@ibexa.api.service.content_type"
        tags:
            - { name: container.service_subscriber }
            - { name: controller.service_arguments }

    netgen_layouts.ibexa.admin.controller.connect_component_content:
        class: Netgen\Bundle\LayoutsIbexaBundle\Controller\Admin\ConnectComponentContent
        parent: netgen_layouts.ibexa.admin.controller.base
        arguments:
            - "@netgen_layouts.api.service.block"
            - "@ibexa.api.service.content"
        tags:
            - { name: container.service_subscriber }
            - { name: controller.service_arguments }

    netgen_layouts.ibexa.admin.controller.delete_rule:
        class: Netgen\Bundle\LayoutsIbexaBundle\Controller\Admin\DeleteRule
        parent: netgen_layouts.ibexa.admin.controller.base
        arguments:
            - "@netgen_layouts.api.service.layout"
            - "@netgen_layouts.api.service.layout_resolver"
        tags:
            - { name: container.service_subscriber }
            - { name: controller.service_arguments }

    netgen_layouts.ibexa.admin.controller.components.index:
        class: Netgen\Bundle\LayoutsIbexaBundle\Controller\Admin\Components\Index
        parent: netgen_layouts.ibexa.admin.controller.base
        arguments:
            - "@netgen_layouts.ibexa.components.components_layout_loader"
            - "@ibexa.config.resolver"
            - "@netgen_layouts.ibexa.search_service"
            - "%netgen_layouts.ibexa.components.limit%"
        tags:
            - { name: container.service_subscriber }
            - { name: controller.service_arguments }

    netgen_layouts.ibexa.components.components_layout_loader:
        class: Netgen\Layouts\Ibexa\AdminUI\ComponentLayoutsLoader
        arguments:
            - "@netgen_layouts.api.service.layout"
            - "@database_connection"

    netgen_layouts.ibexa.event_listener.admin.main_menu_builder:
        class: Netgen\Bundle\LayoutsIbexaBundle\EventListener\Admin\MainMenuBuilderListener
        arguments:
            - "@security.authorization_checker"
        tags:
            - { name: kernel.event_subscriber }

    netgen_layouts.ibexa.event_listener.admin.set_page_layout:
        class: Netgen\Bundle\LayoutsIbexaBundle\EventListener\Admin\SetPageLayoutListener
        arguments:
            - "@request_stack"
            - "%ibexa.site_access.groups_by_site_access%"
            - "%netgen_layouts.ibexa.admin.pagelayout%"
        tags:
            - { name: kernel.event_subscriber }

    netgen_layouts.ibexa.event_listener.admin.cache_enabled:
        class: Netgen\Bundle\LayoutsIbexaBundle\EventListener\Admin\CacheEnabledListener
        arguments:
            - "@netgen_layouts.http_cache.client"
        tags:
            - { name: kernel.event_subscriber }

    netgen_layouts.ibexa.event_listener.admin.is_enterprise_version:
        class: Netgen\Bundle\LayoutsIbexaBundle\EventListener\Admin\IsEnterpriseVersionListener
        arguments:
            - "%netgen_layouts.ibexa.is_enterprise%"
        tags:
            - { name: kernel.event_subscriber }

    netgen_layouts.ibexa.admin.related_layouts_loader:
        class: Netgen\Layouts\Ibexa\AdminUI\RelatedLayoutsLoader
        arguments:
            - "@netgen_layouts.api.service.layout"
            - "@database_connection"

    netgen_layouts.ibexa.admin.tab.location_view.layouts:
        class: Netgen\Layouts\Ibexa\AdminUI\Tab\LocationView\LayoutsTab
        arguments:
            - "@twig"
            - "@translator"
            - "@event_dispatcher"
            - "@Ibexa\\Contracts\\Core\\Repository\\PermissionService"
            - "@security.authorization_checker"
        tags:
            - { name: ibexa.admin_ui.tab, group: location-view }

    netgen_layouts.ibexa.admin.component.stylesheets:
         parent: Ibexa\TwigComponents\Component\TemplateComponent
         arguments:
             - "@twig"
             - "@@ibexadesign/nglayouts/stylesheets.html.twig"
         tags:
             - { name: ibexa.twig.component, group: admin-ui-stylesheet-head }

    netgen_layouts.ibexa.admin.component.javascripts:
         parent: Ibexa\TwigComponents\Component\TemplateComponent
         arguments:
             - "@twig"
             - "@@ibexadesign/nglayouts/javascripts.html.twig"
         tags:
             - { name: ibexa.twig.component, group: admin-ui-script-body }

    netgen_layouts.ibexa.admin.component.meta:
         parent: Ibexa\TwigComponents\Component\TemplateComponent
         arguments:
             - "@twig"
             - "@@ibexadesign/nglayouts/meta.html.twig"
         tags:
             - { name: ibexa.twig.component, group: admin-ui-script-head }
